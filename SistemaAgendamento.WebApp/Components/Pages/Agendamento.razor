@page "/agendamento"
@layout MainLayout
@rendermode InteractiveServer

@using MudBlazor

<div class="container-fluid mt-4 page-background">
    <div class="panel-container">

        <MudPaper Class="pa-2 mb-2 mt-2" Elevation="0">
            <MudText Typo="Typo.h4" Style="color: rgb(28, 154, 186);" Class="fw-bold">Agendamento</MudText>
            <MudText Typo="Typo.subtitle2" Class="text-muted mt-1">
                Selecione o local para iniciar a reserva
            </MudText>
        </MudPaper>
        <MudDivider Class="mb-6" Style="border-color: darkgrey" />

        @if (!string.IsNullOrEmpty(MensagemStatus))
        {
            <MudAlert Severity="Severity.Error" Dense="true" Class="mb-4 shadow-sm">
                @MensagemStatus
            </MudAlert>
        }

        <div class="row g-4">
            @if (ListaDeSalas?.Any() == true)
            {
                @foreach (var sala in ListaDeSalas)
                {
                    <div class="col-12 col-md-6 col-lg-4">

                        <MudPaper Class="sala-card p-0 shadow-sm">

                            <MudCard Class="h-100">

                                <div class="sala-image-container">
                                    @if (string.IsNullOrWhiteSpace(sala.ImagemUrl))
                                    {
                                        <div class="no-image-placeholder">
                                            <MudIcon Icon="@Icons.Material.Filled.PhotoCamera" Color="Color.Secondary" Size="Size.Large" />
                                        </div>
                                    }
                                    else
                                    {
                                        <MudImage Src="@sala.ImagemUrl" Class="sala-image" Alt="Imagem da sala" />
                                    }
                                </div>

                                <MudCardContent Class="p-3">

                                    <h5 class="fw-bold mb-1">@sala.Nome</h5>

                                    <MudChip T="Salas" Color="Color.Info" Variant="Variant.Outlined" Class="mb-2">
                                        <MudIcon Icon="@Icons.Material.Filled.Groups" Class="me-1" />
                                        @sala.Capacidade pessoas
                                    </MudChip>

                                    <div class="text-muted small mb-2">
                                        <MudIcon Icon="@Icons.Material.Filled.LocationOn" Color="Color.Error" Class="me-1" />
                                        @sala.Localizacao
                                    </div>

                                </MudCardContent>

                                <MudCardActions Class="p-3 pt-0 d-flex justify-content-end">
                                    <MudButton Variant="Variant.Filled"
                                               Color="Color.Success"
                                               EndIcon="@Icons.Material.Filled.ArrowForward"
                                               OnClick="() => AbrirFormularioDeReserva(sala.Id)">
                                        Agendar
                                    </MudButton>
                                </MudCardActions>

                            </MudCard>

                        </MudPaper>

                    </div>
                }
            }
            else
            {
                <div class="col-12">
                    <MudPaper Class="text-center p-5 shadow-sm">
                        <MudIcon Icon="@Icons.Material.Filled.MeetingRoom" Size="Size.Large" Color="Color.Default" />
                        <h4 class="mt-3 text-muted">Nenhuma sala disponível</h4>
                        <p class="text-muted">Entre em contato com o administrador para cadastrar novos locais.</p>
                    </MudPaper>
                </div>
            }
        </div>
    </div>
</div>


<style>
    .page-background {
        background-color: #f1f1f1;
        min-height: calc(100vh - 64px);
        padding-bottom: 40px;
    }

    .panel-container {
        background-color: #ffffff;
        border-radius: 12px;
        padding: 25px;
        width: 95%;
        margin: 0 auto;
        box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .sala-card {
        border-radius: 14px;
        overflow: hidden;
        transition: transform .2s ease, box-shadow .2s ease;
    }

    .sala-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 0.8rem 1.5rem rgba(0,0,0,.12) !important;
    }

    .sala-image-container {
        width: 100%;
        height: 180px;
        background: #e9ecef;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .sala-image {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .no-image-placeholder {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        opacity: .4;
    }
</style>
